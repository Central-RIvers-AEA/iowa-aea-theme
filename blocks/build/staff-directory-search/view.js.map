{"version":3,"file":"staff-directory-search/view.js","mappings":"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","sources":["webpack://interactive-map/external module \"@wordpress/interactivity\"","webpack://interactive-map/webpack/bootstrap","webpack://interactive-map/webpack/runtime/make namespace object","webpack://interactive-map/./src/staff-directory-search/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { store, getContext, getElement } from '@wordpress/interactivity';\n\n\nconst { actions } = store( 'iowa-aea-theme/staff-directory-search', {\n  actions: {\n    searchStaff: (e) => {\n      e.preventDefault();\n\n      let context = getContext();\n\n      let formData = new FormData(e.target);\n      let query = formData.get('staff-name');\n      let district = formData.get('district');\n      let building = formData.get('building');\n      let area = formData.get('area');\n\n      let queryObj = {}\n\n      if(query) queryObj.search = query;\n      if(district) queryObj.district = district;\n      if(building) queryObj.building = building;\n      if(area) queryObj.area = area;\n\n      let queryString = new URLSearchParams(queryObj).toString();\n\n      // Query Employee Endpoint\n      fetch(`${context.staffEndpoint}?${queryString}`)\n        .then(response => response.json())\n        .then(data => {\n          console.log(data);\n          context.staff = data;\n        });\n    },\n    filterBuildings: () => {\n      let context = getContext();\n      let districtSelect = getElement();\n\n      let district = districtSelect.ref.value;\n\n      // Clear existing options\n      let form = districtSelect.ref.closest('form');\n      let buildingSelect = form.querySelector('select[name=\"school-building\"]');\n      buildingSelect.innerHTML = '<option value=\"\">Select a District to view Buildings</option>';\n\n      let buildings = context.buildings.filter(building => building.district_id == district)\n\n      if(district) {\n        buildings.forEach(building => {\n          let option = document.createElement('option');\n          option.value = building.id;\n          option.textContent = building.name;\n          buildingSelect.appendChild(option);\n        });\n        buildingSelect.disabled = false;\n      } else {\n        buildingSelect.innerHTML = '<option value=\"\">Select a Building</option>';\n        buildingSelect.disabled = true;\n      }\n    },\n    filterStaff: () => {\n      let context = getContext();\n      let form = getElement();\n\n      let query = form.ref.querySelector('input[name=\"staff-name\"]').value;\n      let district = form.ref.querySelector('select[name=\"school-district\"]').value;\n      let building = form.ref.querySelector('select[name=\"school-building\"]').value;\n      let area = form.ref.querySelector('select[name=\"content-area\"]').value;\n      let position = form.ref.querySelector('select[name=\"position\"]').value;\n\n\n      let filteredStaff = context.staff.filter(member => {\n        let assignments = Object.keys(member.assignments).map(key => member.assignments[key]);\n        \n        return (!query || member.full_name.toLowerCase().includes(query.toLowerCase())) &&\n               (!district || assignments.some(assignment => assignment.district == district)) &&\n               (!building || assignments.some(assignment => assignment.building == building)) &&\n               (!area || assignments.some(assignment => assignment.content_area == area)) &&\n               (!position || member.position == position)\n      });\n\n      return filteredStaff;\n    }\n  },\n  callbacks: {\n    renderStaffList: () => {\n      let context = getContext();\n\n      let staffList = document.querySelector('.staff-directory-results ul');\n      staffList.innerHTML = '';\n\n      let filteredStaff = actions.filterStaff()\n      let sortedStaff = sortByAssignmentPriority(filteredStaff);\n\n      sortedStaff.forEach( member => {\n        // Render each staff member\n        let li = document.createElement('li');\n        let staffMemberTemplate = `\n          <div class='staff-member'>\n            <figure class='staff-image'>\n              <img src='${ member.image }' width='135' height='154' alt='${ member.full_name }' />\n            </figure>\n            <div class='staff-info'>\n              <h3 class='staff-name'>${member.full_name}</h3>\n              <div class='staff-position'>${member.position}</div>\n              <div class='staff-email'>${member.email}</div>\n              <div class='staff-phone'>${member.phone}</div>\n            </div>\n          </div>\n        `\n\n        li.innerHTML = staffMemberTemplate;\n\n        staffList.appendChild(li);\n      });\n    },\n    fillFormOptions: () => {\n      let context = getContext();\n\n      let form = getElement();\n      context.districts.forEach(district => {\n        let option = document.createElement('option');\n        option.value = district.id;\n        option.textContent = district.name;\n        form.ref.querySelector('select[name=\"school-district\"]').appendChild(option);\n      });\n      \n      context.positions.sort().forEach(position => {\n        if(position.trim() != '') {\n          let option = document.createElement('option');\n          option.innerText = position.trim();\n          form.ref.querySelector('select[name=\"position\"]').appendChild(option);\n        }\n      })\n\n      context.contentAreas.sort().forEach(area => {\n        if(area.trim() != '') {\n          let option = document.createElement('option');\n          option.innerText = area.trim();\n          form.ref.querySelector('select[name=\"content-area\"]').appendChild(option);\n        }\n      })\n    }\n  }\n});\n\nfunction sortByAssignmentPriority(staff){\n  console.log(staff)\n  let districtSelect = document.querySelector('#school-district')\n  let buildingSelect = document.querySelector('#school-building')\n  let contentAreaSelect = document.querySelector('#content-area')\n\n  let adjustedItems = staff.map(item => {\n    let newItem = {...item}\n    newItem.assignments_array = []\n\n    if(newItem.assignments) {\n      Object.keys(newItem.assignments).forEach(assignment => {\n        newItem.assignments_array.push(newItem.assignments[assignment])\n      })\n    }\n\n    return newItem\n  })\n\n  console.log(adjustedItems)\n\n  let sortedItems = adjustedItems.sort((itemA, itemB) => {\n    if(districtSelect.value != ''){\n      let assignmentA = itemA.assignments_array.find((assignment) => assignment.district == districtSelect.value)\n      let assignmentB = itemB.assignments_array.find((assignment) => assignment.district == districtSelect.value)\n  \n      if(assignmentA.search_priority == ''){ assignmentA.search_priority = 100 }\n      if(assignmentB.search_priority == ''){ assignmentB.search_priority = 100 }\n\n      return assignmentA.search_priority - assignmentB.search_priority || itemA.last_name.localeCompare(itemB.last_name)\n      \n    } else {\n      return 0;\n    }\n  })\n\n  console.log(sortedItems)\n  console.log('sorted')\n\n  return sortedItems\n}"],"names":["store","getContext","getElement","actions","searchStaff","e","preventDefault","context","formData","FormData","target","query","get","district","building","area","queryObj","search","queryString","URLSearchParams","toString","fetch","staffEndpoint","then","response","json","data","console","log","staff","filterBuildings","districtSelect","ref","value","form","closest","buildingSelect","querySelector","innerHTML","buildings","filter","district_id","forEach","option","document","createElement","id","textContent","name","appendChild","disabled","filterStaff","position","filteredStaff","member","assignments","Object","keys","map","key","full_name","toLowerCase","includes","some","assignment","content_area","callbacks","renderStaffList","staffList","sortedStaff","sortByAssignmentPriority","li","staffMemberTemplate","image","email","phone","fillFormOptions","districts","positions","sort","trim","innerText","contentAreas","contentAreaSelect","adjustedItems","item","newItem","assignments_array","push","sortedItems","itemA","itemB","assignmentA","find","assignmentB","search_priority","last_name","localeCompare"],"sourceRoot":""}