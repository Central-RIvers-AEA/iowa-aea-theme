{"version":3,"file":"events-list/view.js","mappings":"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","sources":["webpack://interactive-map/external module \"@wordpress/interactivity\"","webpack://interactive-map/webpack/bootstrap","webpack://interactive-map/webpack/runtime/make namespace object","webpack://interactive-map/./src/events-list/view.js"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst formatDate = ( dateString ) => {\n  let comfortDateString = `${dateString}T00:00:00`\n  const month = new Intl.DateTimeFormat( 'en-US', { month: 'short', timeZone: 'America/Chicago' } ).format( new Date( comfortDateString ) );\n  const day = new Intl.DateTimeFormat( 'en-US', { day: 'numeric', timeZone: 'America/Chicago' } ).format( new Date( comfortDateString ) );\n  const year = new Intl.DateTimeFormat( 'en-US', { year: 'numeric', timeZone: 'America/Chicago' } ).format( new Date( comfortDateString ) );\n  return `<small>${month}</small> <strong>${day}</strong> <small>${year}</small>`;\n};\n\nconst formatTime = ( timeString ) => {\n  if(timeString == 'All Day'){\n    return 'All Day';\n  }\n\n  let [time, modifier] = timeString.split(' ');\n  if (!modifier) {\n    modifier = 'AM';\n  }\n  let [hours, minutes] = time.split(':');\n  hours = parseInt(hours, 10);\n  \n  if (hours > 12) {\n    hours = (hours - 12).toString();\n    modifier = 'PM';\n  }\n\n  return `${hours}:${minutes} ${modifier}`;\n}\n\nconst fetchGoogleCalendarEvents = async (start_date, end_date) => {\n  // Simulate fetching events from Google Calendar API\n  let calendarID = 'c_b84675c9e32f1f13cf8f8c51952bc13f927182c1bebb70c77572db5211472993@group.calendar.google.com';\n  let apiKey = 'AIzaSyAHRHplEzIo3lIQnXD0Q7m_3uWJxj2Zssg';\n  let calendarURL = `https://www.googleapis.com/calendar/v3/calendars/${calendarID}/events?key=${apiKey}&timeMin=${start_date}T00:00:00Z&timeMax=${end_date}T23:59:59Z`;\n\n  // Fetch events from Google Calendar API\n  const response = await fetch(calendarURL);\n  const data = await response.json();\n\n  // Convert Google Calendar events to local format\n  const events = data.items.map(gEvent => {\n    let event = {\n      id: gEvent.id,\n      title: { rendered: gEvent.summary },\n      event_date: gEvent.start.date || gEvent.start.dateTime.split('T')[0],\n      event_time: gEvent.start.dateTime ? formatTime(gEvent.start.dateTime.split('T')[1]) : 'All Day'\n    }\n\n    return event;\n  });\n\n  return events;\n};\n\nconst fetchEvents = async () => {\n  // fetch from events api\n  let firstOfMonth = new Date(state.currentDate);\n  firstOfMonth.setDate(1);\n\n  let lastOfMonth = new Date(firstOfMonth);\n  lastOfMonth.setMonth(lastOfMonth.getMonth() + 1);\n  lastOfMonth.setDate(0);\n\n  let start_date = firstOfMonth.toISOString().split('T')[0];\n  let end_date = lastOfMonth.toISOString().split('T')[0];\n\n  const response = await fetch(`/wp-json/wp/v2/event?start_date=${start_date}&end_date=${end_date}`);\n  const localEvents = await response.json();\n  \n  // Fetch events from google calendar API\n  const googleCalendarEvents = await fetchGoogleCalendarEvents(start_date, end_date);\n  const allEvents = [...localEvents, ...googleCalendarEvents];\n\n  allEvents.forEach(event => {\n    if(!state.events.find(e => e.id === event.id)) {\n      state.events.push(event);\n    }\n  })\n\n  state.events.sort((a, b) => new Date(a.event_date) - new Date(b.event_date));\n}\n\nconst { state, actions, callbacks } = store( 'iowa-aea-theme/events-list', {\n  state: {\n    events: [],\n    visibleEvents: 3,\n    topEventId: null,\n    currentDate: new Date().toISOString().split('T')[0],\n    currentMonth: new Date().toISOString().split('T')[0].slice(0, 7)\n  },\n  actions: {\n    loadEvents: async () => {\n      await fetchEvents();\n\n      if(state.topEventId === null) {\n        let currentDate = state.currentDate;\n        let firstOfDate = state.events.find(event => event.event_date === currentDate);\n\n        state.topEventId = firstOfDate?.id || state.events.find(event => event.event_date >= currentDate)?.id;\n      }\n\n      actions.updateEventsView();\n    },\n\n    updateEventsView: () => {\n      let eventsList = document.querySelector('.events-list')\n\n      if(!eventsList) return;\n\n      // Load chunk of events\n      let chunkStart = state.events.map(event => event.id).indexOf(state.topEventId);\n      const chunk = state.events.slice(chunkStart, chunkStart +state.visibleEvents);\n\n      eventsList.innerHTML = chunk.map(event => `\n        <li>\n          <div class='event-item'>\n            <div class='event-date'>${ formatDate( event.event_date ) }</div>\n            <div class='event-details'>\n              <strong class='event-title'>${ event.title.rendered }</strong>\n              <span class='event-time'>${ formatTime(event.event_time) }</span>\n              </div>\n          </div>\n        </li>\n      `).join('');\n    }\n  },\n  callbacks: {\n    scrollEvents: () => {\n      state.topEventId = state.events[state.events.map(event => event.id).indexOf(state.topEventId) + 1]?.id || null;\n      if (state.events.map(event => event.id).indexOf(state.topEventId) > state.events.length - state.visibleEvents) {\n        state.topEventId = state.events[state.events.length - state.visibleEvents]?.id || null;\n      } else {\n        actions.updateEventsView();\n      }\n      \n      if(state.events.map(event => event.id).indexOf(state.topEventId) > state.events.length - state.visibleEvents - 1){\n        state.currentDate = new Date(new Date(state.currentDate).setDate(new Date(state.currentDate).getDate() + 1)).toISOString().split('T')[0];\n        actions.loadEvents();\n      }\n\n      // set button states\n      document.querySelector('.load-previous').disabled = false;\n    },\n    scrollBackEvents: () => {\n      state.topEventId = state.events[state.events.map(event => event.id).indexOf(state.topEventId) - 1]?.id || state.events[0]?.id;\n      actions.updateEventsView();\n\n      // set button states\n      if(state.events[0]?.id === state.topEventId) {\n        document.querySelector('.load-previous').disabled = true;\n      }\n    },\n    resetEvents: () => {\n      state.topEventId = null;\n      actions.loadEvents();\n    },\n  },\n  init: {}\n});\n"],"names":["store","getContext","getElement","formatDate","dateString","comfortDateString","month","Intl","DateTimeFormat","timeZone","format","Date","day","year","formatTime","timeString","time","modifier","split","hours","minutes","parseInt","toString","fetchGoogleCalendarEvents","start_date","end_date","calendarID","apiKey","calendarURL","response","fetch","data","json","events","items","map","gEvent","event","id","title","rendered","summary","event_date","start","date","dateTime","event_time","fetchEvents","firstOfMonth","state","currentDate","setDate","lastOfMonth","setMonth","getMonth","toISOString","localEvents","googleCalendarEvents","allEvents","forEach","find","e","push","sort","a","b","actions","callbacks","visibleEvents","topEventId","currentMonth","slice","loadEvents","firstOfDate","updateEventsView","eventsList","document","querySelector","chunkStart","indexOf","chunk","innerHTML","join","scrollEvents","length","getDate","disabled","scrollBackEvents","resetEvents","init"],"sourceRoot":""}